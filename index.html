<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ë‚´ ì²« PWA</title>
    <link rel="manifest" href="manifest.json" />
  </head>
  <body>

    <!-- ğŸ” ì ê¸ˆ í™”ë©´ -->
    <div id="lock">
      <h2>ğŸ” ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”</h2>
      <input type="password" id="pw" placeholder="ë¹„ë°€ë²ˆí˜¸" />
      <button onclick="checkPassword()">í™•ì¸</button>
      <p id="error" style="color:red;"></p>
    </div>

    <!-- âœ… ì‹¤ì œ ì•± í™”ë©´ -->
    <div id="app" style="display:none;">
      <h1>ì•ˆë…•í•˜ì„¸ìš” ğŸ‘‹</h1>
      <button onclick="alert('ë°˜ê°€ì›Œìš”!')">ëˆŒëŸ¬ë³´ì„¸ìš”</button>
    </div>

    <script>
      const PASSWORD = "1234"; // ğŸ”´ ì—¬ê¸° ë¹„ë°€ë²ˆí˜¸ ë³€ê²½

      // ì´ë¯¸ ì¸ì¦í–ˆìœ¼ë©´ ë°”ë¡œ ì•± ë³´ì—¬ì£¼ê¸°
      //if (localStorage.getItem("auth") === "ok") {
        //showApp();
      //}

      function checkPassword() {
        const input = document.getElementById("pw").value;
        if (input === PASSWORD) {
          localStorage.setItem("auth", "ok");
          showApp();
        } else {
          document.getElementById("error").innerText = "ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤";
        }
      }

      function showApp() {
        document.getElementById("lock").style.display = "none";
        document.getElementById("app").style.display = "block";
      }

      // Service Worker ë“±ë¡
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker.register("service-worker.js");
        navigator.serviceWorker.register("service-worker.js").then(reg => {
          reg.onupdatefound = () => {
            const newWorker = reg.installing;
            newWorker.onstatechange = () => {
              if (newWorker.state === "installed" && navigator.serviceWorker.controller) {
                // ìƒˆ ë²„ì „ ê°ì§€ â†’ ìë™ ìƒˆë¡œê³ ì¹¨
                location.reload();
              }
            };
          };
        });
      }
    </script>

  </body>
</html>
